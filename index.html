<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ú¯Ù„Ø¯ÛŒØ§Ø± 2.0 - Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù¾ÛŒØ´Ø±ÙØªÙ‡ ØªØ­Ù„ÛŒÙ„ Ø·Ù„Ø§</title>
    <meta name="description" content="ØªØ­Ù„ÛŒÙ„ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ù‚ÛŒÙ…Øª Ø·Ù„Ø§ØŒ Ù†Ù‚Ø±Ù‡ØŒ Ø¯Ù„Ø§Ø± Ùˆ Ø§Ø±Ø² Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class', // ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ© Ø¨Ø± Ø§Ø³Ø§Ø³ Ú©Ù„Ø§Ø³
            theme: {
                extend: {
                    colors: {
                        'gold': {
                            light: '#fde68a',
                            DEFAULT: '#facc15',
                            dark: '#eab308',
                        },
                        'dark': {
                            'bg': '#111827',
                            'card': '#1f2937',
                            'border': '#374151',
                        }
                    },
                },
            },
        }
    </script>
    <style>
        body { 
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f9fafb;
        }
        .dark body {
            background-color: #111827;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .dark .glass-effect {
            background: rgba(31, 41, 55, 0.6);
            border: 1px solid rgba(55, 65, 81, 0.4);
        }
        .pulse-animation { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .7; } }
    </style>
</head>
<body class="antialiased text-gray-800 dark:text-gray-200">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;

        // --- Context Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ… ---
        const ThemeContext = createContext();

        const ThemeProvider = ({ children }) => {
            const [theme, setTheme] = useState('light');
            useEffect(() => {
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }, [theme]);

            const toggleTheme = () => {
                setTheme(prevTheme => prevTheme === 'light' ? 'dark' : 'light');
            };

            return (
                <ThemeContext.Provider value={{ theme, toggleTheme }}>
                    {children}
                </ThemeContext.Provider>
            );
        };
        
        // --- Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø² API Ø¨Ú©â€ŒØ§Ù†Ø¯ ---
        // Ø¯Ø± ÛŒÚ© Ù¾Ø±ÙˆÚ˜Ù‡ ÙˆØ§Ù‚Ø¹ÛŒØŒ Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¯Ø± Ø³Ø±ÙˆØ± (Ù…Ø«Ù„Ø§ Next.js API Route) Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯
        const mockApi = {
            fetchMarketData: async () => {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ§Ø®ÛŒØ± Ø´Ø¨Ú©Ù‡
                await new Promise(res => setTimeout(res, 800));

                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø®Ø·Ø§ÛŒ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ
                if (Math.random() > 0.95) {
                    throw new Error("Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ù…Ø±Ú©Ø²ÛŒ");
                }
                
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø¨Ø§ Ú©Ù…ÛŒ Ù†ÙˆØ³Ø§Ù†
                const newGoldPrice = 4311 + Math.random() * 20;
                const newSilverPrice = 71 + Math.random() * 2;
                const estimatedUSD = 135600 + (Math.random() - 0.5) * 1000;
                const estimatedMesghal = (newGoldPrice * estimatedUSD) / 9.5742;
                const estimated18Geram = ((newGoldPrice / 31.1) * estimatedUSD) * 0.75;

                return {
                    gold: { price: newGoldPrice, change: (Math.random() - 0.4) * 0.5 },
                    silver: { price: newSilverPrice, change: (Math.random() - 0.5) * 1 },
                    usd: { price: estimatedUSD, change: (Math.random() - 0.5) * 0.2 },
                    mesghalMarket: { price: estimatedMesghal * 1.02, change: (Math.random() - 0.5) * 0.3 },
                    geram18Market: { price: estimated18Geram * 1.015, change: (Math.random() - 0.5) * 0.4 },
                    dirham: { price: 37500, change: (Math.random() - 0.5) * 0.1 },
                    uaeGoldPrice: 39.6,
                };
            }
        };

        // --- Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ ---
        const SunIcon = () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m8.66-15.66l-.707.707M4.34 19.66l-.707.707M21 12h-1M4 12H3m15.66 4.34l-.707-.707M5.05 5.05l-.707-.707" /></svg>;
        const MoonIcon = () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>;
        const UserIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>;
        const LogoutIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>;
        const TrendingUpIcon = () => <svg className="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>;
        const TrendingDownIcon = () => <svg className="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6" /></svg>;

        // --- Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§ ---
        
        function Header({ user, onLoginClick, onLogou }) {
            const { theme, toggleTheme } = useContext(ThemeContext);
            return (
                <header className="sticky top-0 z-40 bg-white/70 dark:bg-dark-bg/70 backdrop-blur-lg shadow-md">
                    <div className="max-w-7xl mx-auto px-4 py-3">
                        <div className="flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-gradient-to-br from-gold to-gold-dark rounded-full flex items-center justify-center shadow-lg">
                                    <span className="text-2xl">ğŸ’°</span>
                                </div>
                                <h1 className="text-xl font-bold text-gray-900 dark:text-white">Ú¯Ù„Ø¯ÛŒØ§Ø±</h1>
                            </div>
                            
                            <div className="flex items-center gap-3">
                                <button onClick={toggleTheme} className="p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-dark-card transition-colors">
                                    {theme === 'light' ? <MoonIcon /> : <SunIcon />}
                                </button>
                                {user ? (
                                    <div className="flex items-center gap-3">
                                        <span className="text-sm font-medium hidden sm:block">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ØŒ {user.name}</span>
                                        <button onClick={onLogout} className="px-3 py-2 bg-red-500 text-white rounded-lg font-bold text-sm hover:bg-red-600 transition-all flex items-center gap-2">
                                            <LogoutIcon />
                                            <span className="hidden sm:block">Ø®Ø±ÙˆØ¬</span>
                                        </button>
                                    </div>
                                ) : (
                                    <button onClick={onLoginClick} className="px-4 py-2 bg-gradient-to-r from-gold to-gold-dark text-white rounded-lg font-bold text-sm hover:shadow-lg hover:shadow-yellow-500/20 transition-all flex items-center gap-2">
                                        <UserIcon />
                                        <span>ÙˆØ±ÙˆØ¯ / Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</span>
                                    </button>
                                )}
                            </div>
                        </div>
                    </div>
                </header>
            );
        }

        function PriceDashboard({ data, isLoading, lastUpdate, onRefresh }) {
            const formatNumber = (num) => new Intl.NumberFormat('fa-IR').format(Math.round(num));
            const PriceCard = ({ title, value, unit, change, icon, color }) => (
                <div className="bg-white dark:bg-dark-card p-4 rounded-xl shadow-sm border-l-4" style={{ borderColor: color }}>
                    <div className="flex items-center justify-between mb-2">
                        <span className="text-sm font-medium text-gray-600 dark:text-gray-400">{icon} {title}</span>
                        {change !== null && (
                            <span className={`text-xs font-bold ${change >= 0 ? 'text-green-500' : 'text-red-500'}`}>
                                {change >= 0 ? 'â–²' : 'â–¼'} {Math.abs(change).toFixed(2)}%
                            </span>
                        )}
                    </div>
                    {isLoading ? 
                        <div className="h-7 w-2/3 bg-gray-200 dark:bg-gray-600 rounded animate-pulse"></div> :
                        <p className="text-2xl font-bold text-gray-900 dark:text-white">{formatNumber(value)}</p>
                    }
                    <p className="text-xs text-gray-500 dark:text-gray-400 mt-1">{unit}</p>
                </div>
            );

            return (
                 <div className="bg-white/50 dark:bg-dark-card/50 glass-effect rounded-2xl p-4 shadow-lg">
                    <div className="flex justify-between items-center mb-4">
                        <h3 className="text-md font-bold text-gray-700 dark:text-gray-200 flex items-center gap-2">
                            <span className="pulse-animation inline-block w-2 h-2 bg-green-500 rounded-full"></span>
                            Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ
                        </h3>
                        <div className="flex items-center gap-2">
                            <span className="text-xs text-gray-500 dark:text-gray-400">
                                {lastUpdate ? `Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: ${lastUpdate.toLocaleTimeString('fa-IR')}` : ''}
                            </span>
                             <button onClick={onRefresh} disabled={isLoading} className="p-2 bg-gold text-white rounded-full hover:bg-gold-dark transition-all disabled:opacity-50 disabled:animate-spin">
                                <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                            </button>
                        </div>
                    </div>
                    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3">
                       <PriceCard title="Û±Û¸ Ø¹ÛŒØ§Ø±" value={data.geram18Market.price} unit="ØªÙˆÙ…Ø§Ù†/Ú¯Ø±Ù…" change={data.geram18Market.change} icon="ğŸ‡®ğŸ‡·" color="#eab308" />
                       <PriceCard title="Ù…Ø«Ù‚Ø§Ù„" value={data.mesghalMarket.price} unit="ØªÙˆÙ…Ø§Ù†" change={data.mesghalMarket.change} icon="ğŸ‡®ğŸ‡·" color="#ca8a04" />
                       <PriceCard title="Ø¯Ù„Ø§Ø±" value={data.usd.price} unit="ØªÙˆÙ…Ø§Ù†" change={data.usd.change} icon="ğŸ‡ºğŸ‡¸" color="#16a34a" />
                       <PriceCard title="Ø§Ù†Ø³ Ø¬Ù‡Ø§Ù†ÛŒ" value={data.gold.price} unit="Ø¯Ù„Ø§Ø±" change={data.gold.change} icon="ğŸŒ" color="#0284c7" />
                       <PriceCard title="Ø¯Ø±Ù‡Ù…" value={data.dirham.price} unit="ØªÙˆÙ…Ø§Ù†" change={data.dirham.change} icon="ğŸ‡¦ğŸ‡ª" color="#ea580c" />
                       <PriceCard title="Ù†Ù‚Ø±Ù‡ Ø¬Ù‡Ø§Ù†ÛŒ" value={data.silver.price} unit="Ø¯Ù„Ø§Ø±" change={data.silver.change} icon="ğŸ’" color="#64748b" />
                    </div>
                </div>
            )
        }
        
        function MainChart({ data, isLoading }) {
            // Ø§ÛŒÙ† ÛŒÚ© Ù†Ù…ÙˆØ¯Ø§Ø± Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø¯Ø± Ù†Ø³Ø®Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ Ø§Ø² Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒØ§ÛŒ Ù…Ø«Ù„ Chart.js Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            const chartData = [10, 40, 35, 80, 50, 90, 70];
            return (
                <div className="bg-white dark:bg-dark-card p-4 rounded-2xl shadow-lg h-80 flex flex-col">
                    <h3 className="text-md font-bold text-gray-700 dark:text-gray-200 mb-2">Ù†Ù…ÙˆØ¯Ø§Ø± Ø±ÙˆØ²Ø§Ù†Ù‡ Ù‚ÛŒÙ…Øª Ø·Ù„Ø§ (Û±Û¸ Ø¹ÛŒØ§Ø±)</h3>
                    <div className="flex-grow flex items-center justify-center relative">
                        {isLoading ? (
                            <div className="w-full h-full bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"></div>
                        ) : (
                            <div className="w-full h-full flex items-end justify-between gap-2">
                               {chartData.map((height, i) => (
                                    <div key={i} className="bg-gradient-to-t from-gold-light to-gold rounded-t-md w-full transition-all duration-300" 
                                         style={{height: `${height}%`, animation: `bar-up .5s ease-out ${i * 0.05}s backwards`}}>
                                    </div>
                               ))}
                               <style>{`
                                   @keyframes bar-up {
                                       from { height: 0; }
                                   }
                               `}</style>
                            </div>
                        )}
                        <div className="absolute top-2 right-2 flex gap-2">
                            <button className="text-xs bg-gold-light/50 dark:bg-gold-dark/50 px-3 py-1 rounded-full font-semibold">Ø±ÙˆØ²Ø§Ù†Ù‡</button>
                             <button className="text-xs px-3 py-1 rounded-full">Ù‡ÙØªÚ¯ÛŒ</button>
                        </div>
                    </div>
                </div>
            );
        }
        
        function AnalysisCard({ title, marketPrice, theoPrice, diff, percent, signal, isLoading }) {
            const getSignalColor = (p) => p > 0.1 ? 'text-green-500' : p < -0.1 ? 'text-red-500' : 'text-gray-500';
            const getSignalBg = (p) => p > 0.1 ? 'bg-green-500/10' : p < -0.1 ? 'bg-red-500/10' : 'bg-gray-500/10';
            const formatNumber = (num) => new Intl.NumberFormat('fa-IR').format(Math.round(num));
            
            return (
                 <div className="bg-white dark:bg-dark-card rounded-2xl shadow-lg p-4 space-y-3">
                    <h3 className="font-bold text-gray-800 dark:text-white">{title}</h3>
                    {isLoading ? (
                        <div className="space-y-2">
                            <div className="h-10 w-full bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"></div>
                            <div className="h-20 w-full bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"></div>
                        </div>
                    ) : (
                        <>
                            <div className="grid grid-cols-2 gap-2 text-center">
                                <div className="bg-gray-100 dark:bg-dark-bg p-2 rounded-lg">
                                    <span className="text-xs text-gray-500">Ù‚ÛŒÙ…Øª Ø¨Ø§Ø²Ø§Ø±</span>
                                    <p className="font-bold text-lg">{formatNumber(marketPrice)}</p>
                                </div>
                                <div className="bg-gray-100 dark:bg-dark-bg p-2 rounded-lg">
                                    <span className="text-xs text-gray-500">Ø§Ø±Ø²Ø´ Ø°Ø§ØªÛŒ</span>
                                    <p className="font-bold text-lg">{formatNumber(theoPrice)}</p>
                                </div>
                            </div>
                             <div className={`p-3 rounded-lg ${getSignalBg(percent)}`}>
                                <div className="flex justify-between items-center">
                                    <span className="text-sm font-semibold">ÙˆØ¶Ø¹ÛŒØª Ø­Ø¨Ø§Ø¨</span>
                                    <span className={`font-bold text-lg ${getSignalColor(percent)}`}>{percent > 0 ? '+' : ''}{percent}%</span>
                                </div>
                                <p className={`text-center mt-2 font-bold ${getSignalColor(percent)}`}>{signal}</p>
                            </div>
                        </>
                    )}
                 </div>
            );
        }

        function LoginModal({ onLogin, onShowRegister, onClose }) {
            return (
                <div className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4 backdrop-blur-sm" onClick={onClose}>
                    <div className="bg-white dark:bg-dark-card rounded-2xl p-8 max-w-sm w-full shadow-2xl transform transition-all" onClick={(e) => e.stopPropagation()}>
                        <h2 className="text-2xl font-bold text-gray-800 dark:text-white mb-2 text-center">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ú¯Ù„Ø¯ÛŒØ§Ø±</h2>
                        <div className="space-y-4 mt-6">
                            <input type="tel" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„" className="w-full px-4 py-3 rounded-lg bg-gray-100 dark:bg-dark-bg border-2 border-transparent focus:border-gold outline-none transition-all" />
                            <button onClick={() => onLogin({name: 'Ú©Ø§Ø±Ø¨Ø±'})} className="w-full bg-gradient-to-r from-gold to-gold-dark text-white py-3 rounded-lg font-bold hover:shadow-lg transition-all">ÙˆØ±ÙˆØ¯</button>
                        </div>
                        <p className="mt-6 text-center text-sm">Ø­Ø³Ø§Ø¨ Ù†Ø¯Ø§Ø±ÛŒØ¯ØŸ <button onClick={onShowRegister} className="text-gold font-bold hover:underline">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†ÛŒØ¯</button></p>
                    </div>
                </div>
            );
        }

        // --- Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø§ØµÙ„ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ ---
        function App() {
            const [data, setData] = useState({ gold: {}, silver: {}, usd: {}, mesghalMarket: {}, geram18Market: {}, dirham: {} });
            const [isLoading, setIsLoading] = useState(true);
            const [error, setError] = useState(null);
            const [lastUpdate, setLastUpdate] = useState(null);
            const [showLogin, setShowLogin] = useState(false);
            const [user, setUser] = useState(null); // ÙˆØ¶Ø¹ÛŒØª Ú©Ø§Ø±Ø¨Ø±: null ÛŒØ¹Ù†ÛŒ Ù„Ø§Ú¯ÛŒÙ† Ù†Ú©Ø±Ø¯Ù‡

            const fetchData = () => {
                setIsLoading(true);
                mockApi.fetchMarketData()
                    .then(marketData => {
                        setData(marketData);
                        setError(null);
                        setLastUpdate(new Date());
                    })
                    .catch(err => {
                        setError(err.message);
                    })
                    .finally(() => {
                        setIsLoading(false);
                    });
            };

            useEffect(() => {
                fetchData(); // Ø¯Ø±ÛŒØ§ÙØª Ø§ÙˆÙ„ÛŒÙ‡
                const interval = setInterval(fetchData, 30000); // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
                return () => clearInterval(interval);
            }, []);

            const handleLogin = (userData) => {
                setUser(userData);
                setShowLogin(false);
            };
            const handleLogout = () => setUser(null);

            // Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø§Ø±Ø²Ø´ Ø°Ø§ØªÛŒ Ùˆ Ø­Ø¨Ø§Ø¨
            const geram18Theo = ((data.gold.price / 31.1) * data.usd.price) * 0.75;
            const diffGeram18 = data.geram18Market.price - geram18Theo;
            const geram18Percent = data.geram18Market.price ? ((diffGeram18 / data.geram18Market.price) * 100).toFixed(2) : 0;
            const geram18Signal = diffGeram18 > 50000 ? "Ø­Ø¨Ø§Ø¨ Ù…Ø«Ø¨Øª âš ï¸" : diffGeram18 < -50000 ? "Ø­Ø¨Ø§Ø¨ Ù…Ù†ÙÛŒ âœ…" : "Ù…Ø­Ø¯ÙˆØ¯Ù‡ ØªØ¹Ø§Ø¯Ù„";
            
            const dirhamValue = data.dirham.price * data.uaeGoldPrice;
            const diffDirham = data.geram18Market.price - dirhamValue;
            const dirhamPercent = data.geram18Market.price ? ((diffDirham / data.geram18Market.price) * 100).toFixed(2) : 0;
            const dirhamSignal = diffDirham > 50000 ? "Ø±ÛŒØ³Ú© Ø¢Ø±Ø¨ÛŒØªØ±Ø§Ú˜ ğŸ“‰" : diffDirham < -50000 ? "ÙØ±ØµØª Ø¢Ø±Ø¨ÛŒØªØ±Ø§Ú˜ ğŸ“ˆ" : "Ù…Ø­Ø¯ÙˆØ¯Ù‡ ØªØ¹Ø§Ø¯Ù„";

            return (
                <ThemeProvider>
                    <div className="min-h-screen bg-gray-50 dark:bg-dark-bg transition-colors duration-300">
                        <Header user={user} onLoginClick={() => setShowLogin(true)} onLogout={handleLogout} />
                        
                        {showLogin && <LoginModal onLogin={handleLogin} onClose={() => setShowLogin(false)} onShowRegister={() => {}} />}

                        <main className="max-w-7xl mx-auto px-4 py-6 space-y-6">
                            {error && (
                                <div className="bg-red-100 dark:bg-red-900/50 border-r-4 border-red-500 rounded-lg p-4 text-center">
                                    <p className="text-red-700 dark:text-red-200 font-bold">{error}</p>
                                </div>
                            )}
                            <PriceDashboard data={data} isLoading={isLoading} lastUpdate={lastUpdate} onRefresh={fetchData} />
                            
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                <div className="lg:col-span-2">
                                     <MainChart data={data} isLoading={isLoading} />
                                </div>
                                <div className="space-y-6">
                                    <AnalysisCard
                                        title="ØªØ­Ù„ÛŒÙ„ Ø­Ø¨Ø§Ø¨ Û±Û¸ Ø¹ÛŒØ§Ø±"
                                        marketPrice={data.geram18Market.price}
                                        theoPrice={geram18Theo}
                                        diff={diffGeram18}
                                        percent={geram18Percent}
                                        signal={geram18Signal}
                                        isLoading={isLoading}
                                    />
                                    <AnalysisCard
                                        title="ØªØ­Ù„ÛŒÙ„ Ø¢Ø±Ø¨ÛŒØªØ±Ø§Ú˜ Ø¨Ø§ Ø¯Ø±Ù‡Ù…"
                                        marketPrice={data.geram18Market.price}
                                        theoPrice={dirhamValue}
                                        diff={diffDirham}
                                        percent={dirhamPercent}
                                        signal={dirhamSignal}
                                        isLoading={isLoading}
                                    />
                                </div>
                            </div>
                        </main>
                    </div>
                </ThemeProvider>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
